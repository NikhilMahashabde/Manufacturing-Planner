{% extends "index.html" %}

{% block title %} 
<a href="/"> Home</a> 
 / 
<a href="/workorders"> Work Orders</a> 
 / 
<a href="/workorder/{{ idnumber }}"> {{ idnumber }} </a>

{% endblock %}
{% block tabletitle %} {{ idnumber }} {% endblock %}

{% block main %}

<!-- <button onclick="window.location.href='/forms/workorder/add'">Create New Order</button> -->
<form method="POST" action="/workorder/{{ idnumber }}/edit">

    <div style="margin: 10px; background-color: white;">
      <button type="submit" name="{{ idnumber }}" value="delete">Delete Work Order {{ idnumber }} </button>
      <button type="submit" name="{{ idnumber }}" value="update">Edit Work order</button>
    </div>
    
    <div style="margin: 10px; background-color: white;">

      <table class="table" id = "workorder.{{ idnumber }}.table" style="margin: 10px; background-color: white;">
        <thead>
          <tr>
            <th scope="workOrderNumber">Name</th>
            <th scope="itemNumber">Item Number</th>
            <th scope="Itemdescription">Item Description</th>
            <th scope="quantity">Quantity</th>
            <th scope="project">Project</th>
            <th scope="duedate">Due Date</th>
          </tr>
        </thead>
        <tbody id="tableWorkOrder.{{ idnumber }}.Body">
  
        </tbody>
      </table>

    </div>
   
  <div class="d-flex justify-content-center" id="loadingSpinner">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>



  <h2> Work Order status</h2>

  <div id = "woStatusSwitches">


    <div class="form-check form-check-inline" disabled>
      <input class="form-check-input" type="checkbox" id="inlineCheckboxFirmed" value="option1" disabled>
      <label class="form-check-label" for="inlineCheckbox1">Order Firmed</label>
    </div>

    <div class="form-check form-check-inline" disabled>
      <input class="form-check-input" type="checkbox" id="inlineCheckboxDisassembled" value="option2" disabled>
      <label class="form-check-label" for="inlineCheckbox2">Disassembled</label>
    </div>

    <div class="form-check form-check-inline" disabled>
      <input class="form-check-input" type="checkbox" id="inlineCheckboxReceived" value="option1" disabled>
      <label class="form-check-label" for="inlineCheckbox1">Order Received</label>
    </div>

    <div class="form-check form-check-inline" disabled>
      <input class="form-check-input" type="checkbox" id="inlineCheckboxReassembled" value="option1" disabled>
      <label class="form-check-label" for="inlineCheckbox1">Order Reassembled</label>
    </div>

    <div class="form-check form-check-inline" disabled>
      <input class="form-check-input" type="checkbox" id="inlineCheckboxRework" value="option1" disabled>
      <label class="form-check-label" for="inlineCheckbox1">Order Rework</label>
    </div>

    <div class="form-check form-check-inline" disabled>
      <input class="form-check-input" type="checkbox" id="inlineCheckboxClosed" value="option1" disabled>
      <label class="form-check-label" for="inlineCheckbox1">Order Closed</label>
    </div>
   
    </div>

    <div>
      <h2>History</h2>

    </div>




  <div class="mb-3" style="margin: 10px; background-color: white;">
    <!-- api link -->
   
  </div>
  <div class="mb-3" style="margin: 10px; background-color: white";>
    <!-- api link -->
  </div>
  
</form>

{% endblock %}

{% block jsscripts %}
<script>



    


  fetch('/api/workorder/{{ idnumber }}')
    .then(response => response.json())
    .then(data => {
      console.log(data);
      console.log(data);
      [...document.getElementsByClassName("spinner-border")].forEach(element => {
        element.remove()
      });

      let woTable = document.getElementById("tableWorkOrder.{{idnumber}}.Body");
      
       for (let i = 0; i < data.header.length; i++) {
          let row = woTable.insertRow();
          // let cell0 = row.insertCell();
          // let tickbox = document.createElement("input")
          // tickbox.type = "checkbox" 
          // tickbox.name = workorder[i].wonumber + ".selected";
          // cell0.appendChild(tickbox)

          let cell1 = row.insertCell();
          let woLink = document.createElement("a")
          woLink.href = `/workorder/${data.header[i].wonumber}`
          woLink.textContent = data.header[i].wonumber
          cell1.appendChild(woLink)

          let cell2 = row.insertCell();
          cell2.textContent = data.header[i].itemnumber;

          let cell3 = row.insertCell();
          cell3.textContent = data.header[i].itemdescription;

          let cell4 = row.insertCell();
          cell4.textContent = data.header[i].quantity;

          let cell5 = row.insertCell();
          cell5.textContent = data.header[i].project;
          
          let cell6 = row.insertCell();
          cell6.textContent = data.header[i].duedate;

          let firmedBox = document.getElementById("inlineCheckboxFirmed")
          if (data.detail[i].firmed){
            firmedBox.setAttribute("checked","")
          }

          let disassembledBox = document.getElementById("inlineCheckboxFirmed")
          if (data.detail[i].disassembled){
            disassembledBox.setAttribute("checked","")
          }

          let receivedBox = document.getElementById("inlineCheckboxFirmed")
          if (data.detail[i].received){
            receivedBox.setAttribute("checked","")
          }

          let reassembledBox = document.getElementById("inlineCheckboxFirmed")
          if (data.detail[i].firmed){
            reassembledBox.setAttribute("checked","")
          }

          let reworkBox = document.getElementById("inlineCheckboxFirmed")
          if (data.detail[i].rework){
            reworkBox.setAttribute("checked","")
          }

          let closedBox = document.getElementById("inlineCheckboxFirmed")
          if (data.detail[i].closed){
            closedBox.setAttribute("checked","")
          }
          

          


          
    // <div class="form-check form-check-inline">
    //   <input class="form-check-input" type="checkbox" id="inlineCheckboxFirmed" value="option1">
    //   <label class="form-check-label" for="inlineCheckbox1">Order Firmed</label>
    // </div>

    // <div class="form-check form-check-inline">
    //   <input class="form-check-input" type="checkbox" id="inlineCheckboxDisassembled" value="option2">
    //   <label class="form-check-label" for="inlineCheckbox2">Disassembled</label>
    // </div>

    // <div class="form-check form-check-inline">
    //   <input class="form-check-input" type="checkbox" id="inlineCheckboxReceived" value="option1">
    //   <label class="form-check-label" for="inlineCheckbox1">Order Received</label>
    // </div>

    // <div class="form-check form-check-inline">
    //   <input class="form-check-input" type="checkbox" id="inlineCheckboxReassembled" value="option1">
    //   <label class="form-check-label" for="inlineCheckbox1">Order Reassembled</label>
    // </div>

    // <div class="form-check form-check-inline">
    //   <input class="form-check-input" type="checkbox" id="inlineCheckboxRework" value="option1">
    //   <label class="form-check-label" for="inlineCheckbox1">Order Rework</label>
    // </div>

    // <div class="form-check form-check-inline">
    //   <input class="form-check-input" type="checkbox" id="inlineCheckboxClosed" value="option1">
    //   <label class="form-check-label" for="inlineCheckbox1">Order Closed</label>
    // </div>


          

        }
      }
    )
    .catch(error => console.error(error));
</script>

{% endblock %}